{"version":3,"sources":["afterwater.js"],"names":["cc","Class","extends","Component","init","data","kettlevalue","hidehasenergy","that","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","copydata","flowerbed","find","code","getChildByName","getComponent","RichText","string","processbar","str","Label","valuegroup","split","arr","hasenergy","parseInt","value","totalenergy","ctx","Graphics","progpercent","moveTo","clear","lineTo","stroke","loader","load","level_image","err","texture","Sprite","spriteFrame","SpriteFrame","successplant","active","num","replace","kettletip","scheduleOnce","urlstr","location","href","open","setRequestHeader","send","node"],"mappings":"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","file":"afterwater.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    init(data){\r\n        this.kettlevalue = data.kettlevalue;//传入firstprize节点和水壶内的量和增加的量\r\n    },\r\n\r\n    hidehasenergy:function(){\r\n        var that = this;\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function(){\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                var copydata = response.data;\r\n                that.flowerbed = cc.find(\"Canvas/bigback/background2/GrassBud/stage\");\r\n                if(copydata.code){\r\n                    if(copydata.code==4001){\r\n                        //先领取奖励吧\r\n                        that.flowerbed.getChildByName(\"tiprectangle1\").getChildByName(\"tip\").getComponent(cc.RichText).string = '<b>植物成熟不需要浇水</b>';\r\n                    }else if(copydata.code==4002){\r\n                        //去商店种植                      \r\n                        that.flowerbed.getChildByName(\"tiprectangle1\").getChildByName(\"tip\").getComponent(cc.RichText).string = '<b>农庄空着去商店看看</b>';\r\n                    }else if(copydata.code==4003){\r\n                        //水壶空了                      \r\n                        that.flowerbed.getChildByName(\"tiprectangle1\").getChildByName(\"tip\").getComponent(cc.RichText).string = '<b>水壶空了去领水滴吧</b>';\r\n                    }else if(copydata.code==4004){\r\n                        //水滴不够了                      \r\n                        that.flowerbed.getChildByName(\"tiprectangle1\").getChildByName(\"tip\").getComponent(cc.RichText).string = '<b>水滴不够去领水滴吧</b>';\r\n                    }\r\n                    //水壶空了在watering判断了\r\n                }else if(response.code==1){\r\n                    that.processbar = cc.find(\"Canvas/GroupUserinfo/processbar\");\r\n                    var str = that.processbar.getChildByName(\"ProgressLabel\").getComponent(cc.Label).string;\r\n                    var valuegroup = str.split('：');\r\n                    var arr = valuegroup[1].split('/');\r\n                    var hasenergy = parseInt(arr[0]) + 10;\r\n                    var value = hasenergy == 750?0:hasenergy;\r\n                    var totalenergy = parseInt(arr[1]);\r\n                    that.processbar.getChildByName(\"ProgressLabel\").getComponent(cc.Label).string = '进度：'+value+'/'+totalenergy;\r\n                    var ctx = that.processbar.getChildByName(\"progressbar\").getComponent(cc.Graphics);\r\n                    var progpercent = (value/totalenergy)*160;\r\n                    ctx.moveTo(0,17);\r\n                    hasenergy==750?ctx.clear():'';\r\n                    ctx.lineTo(progpercent,17);\r\n                    ctx.stroke();\r\n                    that.flowerbed.getChildByName(\"tiprectangle1\").getChildByName(\"tip\").getComponent(cc.RichText).string = '<b>我长大啦\\n主人离奖品更近一步啦</b>';\r\n                    if(hasenergy==150||hasenergy==400||hasenergy==750){\r\n                        cc.loader.load(copydata.level_image, function (err, texture) {\r\n                            that.flowerbed.getComponent(cc.Sprite).spriteFrame = new cc.SpriteFrame(texture);\r\n                        });\r\n                        if(hasenergy==400){\r\n                            that.flowerbed.getChildByName(\"tiprectangle1\").getChildByName(\"tip\").getComponent(cc.RichText).string = '<b>我长大啦，\\n主人离奖品只差一步啦</b>';\r\n                        }else if(hasenergy==750){\r\n                            that.flowerbed.getChildByName(\"tiprectangle1\").getChildByName(\"tip\").getComponent(cc.RichText).string = '<b>种植成功，\\n快去领取奖励吧</b>';\r\n\r\n                            that.successplant = cc.find(\"Canvas/GroupUserinfo/completed\");\r\n                            that.successplant.active = true;\r\n                            that.processbar.active = false;\r\n                        }\r\n                    }\r\n                    \r\n                    var num = parseInt(that.kettlevalue.string.replace(/\\<b\\>([0-9]+)g\\<\\/b\\>/g, '$1')) - 10;\r\n                    if(num>=0){\r\n                        that.kettlevalue.string = '<b>'+ num +'g</b>';//找到根节点然后改变水壶的显示值\r\n                        if(num==0){\r\n                            that.kettletip = cc.find(\"Canvas/kettle/tip\");\r\n                            that.kettletip.getChildByName(\"text\").getComponent(cc.RichText).string = '<b>水壶空了去领水滴吧</b>';\r\n                            that.kettletip.active = true;\r\n                            that.scheduleOnce(function() {\r\n                                that.kettletip.active = false;\r\n                            }, 3);\r\n                        }\r\n                    }\r\n                }\r\n                that.flowerbed.getChildByName(\"tiprectangle1\").active = true;\r\n                that.scheduleOnce(function() {\r\n                   that.flowerbed.getChildByName(\"tiprectangle1\").active = false;\r\n                }, 3);\r\n            }\r\n        };\r\n        var urlstr = location.href=='http://localhost:7456/'?'http://game.com':'https://h5xyx.jinlingkeji.cn';\r\n        xhr.open('POST',urlstr+'/api/v11/game/reduceWater',true);\r\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded; charset=UTF-8\");\r\n        xhr.send();\r\n        this.node.active = false;\r\n    }\r\n});\r\n"]}