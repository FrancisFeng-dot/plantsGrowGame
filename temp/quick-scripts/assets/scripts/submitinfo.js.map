{"version":3,"sources":["submitinfo.js"],"names":["cc","Class","extends","Component","properties","username","Label","phone","verifycode","address","countdown","default","type","Node","requestNode","onLoad","layermsg","find","start","getverifycode","that","count","getComponent","Button","interactable","callback1","getChildByName","RichText","string","unschedule","schedule","xhr","XMLHttpRequest","onreadystatechange","readyState","status","response","JSON","parse","responseText","layeropen","msg","urlstr","location","href","open","setRequestHeader","send","getinfo","event","customEventData","node","Animation","play","scheduleOnce","myreg","length","test","code","mask","parentnode","successplant","processbar","flowerbed","height","active","Sprite","spriteFrame","setTimeout","info"],"mappings":"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","file":"submitinfo.js","sourceRoot":"..\\..\\..\\..\\assets\\scripts","sourcesContent":["cc.Class({\r\n    extends: cc.Component,\r\n\r\n    properties: {\r\n        username: cc.Label,\r\n        phone: cc.Label,\r\n        verifycode: cc.Label,\r\n        address: cc.Label,\r\n        countdown: {\r\n            default: null,\r\n            type: cc.Node\r\n        },\r\n\r\n        requestNode: {\r\n            default: null,\r\n            type: cc.Node\r\n        }\r\n    },\r\n\r\n    onLoad () {\r\n        this.layermsg = cc.find(\"Canvas/layertip\");\r\n    },\r\n\r\n    start () {\r\n\r\n    },\r\n\r\n    getverifycode(){\r\n        var that = this;\r\n        that.count = 60;\r\n        that.countdown.getComponent(cc.Button).interactable = false;\r\n        that.callback1 = function () {\r\n            if (that.count == 0) {\r\n                that.countdown.getChildByName(\"Background\").getChildByName(\"codetext\").getComponent(cc.RichText).string = '重新获取';\r\n                that.countdown.getComponent(cc.Button).interactable = true;\r\n                that.unschedule(that.callback1);\r\n            }else{\r\n                that.count--;\r\n                that.countdown.getChildByName(\"Background\").getChildByName(\"codetext\").getComponent(cc.RichText).string = that.count+'s';\r\n            }\r\n        }\r\n        that.schedule(that.callback1, 1);\r\n        var xhr = new XMLHttpRequest();\r\n        xhr.onreadystatechange = function(){\r\n            if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                var response = JSON.parse(xhr.responseText);\r\n                that.layeropen(response.msg);\r\n            }\r\n        };\r\n        var urlstr = location.href=='http://localhost:7456/'?'http://game.com':'https://h5xyx.jinlingkeji.cn';\r\n        xhr.open('POST',urlstr+'/api/v10/sms/send',true);\r\n        xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded; charset=UTF-8\");\r\n        xhr.send('mobile='+that.phone.string);\r\n    },\r\n\r\n    getinfo(event, customEventData){\r\n        var that = this;\r\n        that.node.getChildByName(\"btnrequest\").getComponent(cc.Animation).play('scale109');\r\n        that.scheduleOnce(function() {\r\n            var myreg = /^(((11[0-9]{1})|(13[0-9]{1})|(14[0-9]{1})|(17[0-9]{1})|(15[0-9]{1})|(18[0-9]{1}))+\\d{8})$/;\r\n            if(!that.username.string){\r\n                that.layeropen('请输入姓名');\r\n            }else if(!that.phone.string){\r\n                that.layeropen('请输入手机号');\r\n            }else if(!that.verifycode.string){\r\n                that.layeropen('请输入验证码');\r\n            }else if(!that.address.string){\r\n                that.layeropen('请输入地址');\r\n            }else if(that.phone.string.length != 11){\r\n                that.layeropen('请输入有效的手机号码');\r\n            }else if(!myreg.test(that.phone.string)){\r\n                that.layeropen('请输入有效的手机号码');\r\n            }else{\r\n                var xhr = new XMLHttpRequest();\r\n                xhr.onreadystatechange = function(){\r\n                    if (xhr.readyState == 4 && (xhr.status >= 200 && xhr.status < 400)) {\r\n                        var response = JSON.parse(xhr.responseText);\r\n                        that.layeropen(response.msg);\r\n                        if(response.code==1){\r\n                            that.mask = cc.find(\"Canvas/masklayer\");\r\n                            that.parentnode = cc.find(\"Canvas/submitinfo\");\r\n                            that.successplant = cc.find(\"Canvas/GroupUserinfo/completed\");\r\n                            that.processbar = cc.find(\"Canvas/GroupUserinfo/processbar\");\r\n                            that.flowerbed = cc.find(\"Canvas/bigback/background2/GrassBud/stage\");\r\n                            that.flowerbed.height = 200;\r\n                            that.mask.active = false;\r\n                            that.parentnode.active = false;\r\n                            that.successplant.active = false;\r\n                            that.processbar.active = true;\r\n                            \r\n                            that.flowerbed.getComponent(cc.Sprite).spriteFrame = '';\r\n                            that.flowerbed.getChildByName(\"tiprectangle1\").getChildByName(\"tip\").getComponent(cc.RichText).string = '<b>农庄现在空着哦\\n去商店看看下一个植物吧</b>';\r\n                            that.flowerbed.getChildByName(\"tiprectangle1\").active = true;\r\n                            setTimeout(function() {\r\n                                that.flowerbed.getChildByName(\"tiprectangle1\").active = false;\r\n                            }, 4000);\r\n                        }\r\n                    }\r\n                };\r\n                var urlstr = location.href=='http://localhost:7456/'?'http://game.com':'https://h5xyx.jinlingkeji.cn';\r\n                xhr.open('POST',urlstr+'/api/v11/game/getDeliveryAddress',true);\r\n                xhr.setRequestHeader(\"Content-type\", \"application/x-www-form-urlencoded; charset=UTF-8\");\r\n                xhr.send('name='+that.username.string+'&mobile='+that.phone.string+'&code='+that.verifycode.string+'&address='+that.address.string);\r\n            }\r\n        }, 0.4);\r\n    },\r\n\r\n    layeropen(info){\r\n        var that = this;\r\n        that.layermsg.getChildByName(\"layermsg\").getComponent(cc.Label).string = info;\r\n        that.layermsg.active = true;\r\n        setTimeout(function() {\r\n            that.layermsg.active = false;\r\n        }, 3000);\r\n    }\r\n});\r\n"]}